(this["webpackJsonpapp-desktop"]=this["webpackJsonpapp-desktop"]||[]).push([[3,11],{1095:function(e,t,n){e.exports={resolve:{react:n(0),"styled-components":n(8),"styled-system":n(19),"react-dnd":n(1109),"react-dnd-html5-backend":n(1110),"@prifina/hooks":n(202),moment:n(1084),"moment-timezone":n(1086)}}},433:function(e,t,n){"use strict";n.r(t),n.d(t,"WidgetWrapper",(function(){return k})),n.d(t,"IconDiv",(function(){return R})),n.d(t,"WidgetContainer",(function(){return L})),n.d(t,"ModalBackground",(function(){return A})),n.d(t,"SearchContainer",(function(){return N})),n.d(t,"SettingsDiv",(function(){return P})),n.d(t,"WidgetList",(function(){return W})),n.d(t,"SettingsDialog",(function(){return B})),n.d(t,"SearchBox",(function(){return z})),n.d(t,"SearchResults",(function(){return K})),n.d(t,"SearchHistory",(function(){return F}));var r,c,i,o,a,s,l=n(7),u=n(9),d=n(24),h=n(14),f=n(0),g=n.n(f),j=n(8),p=n(3),b=n(91),O=n(434),x=n.n(O),v=n(255),w=n.n(v),m=n(256),y=n.n(m),S=function(e){var t=Object(f.useState)(null),n=Object(u.a)(t,2),r=n[0],c=n[1],i=Object(f.useState)(null),o=Object(u.a)(i,2),a=o[0],s=o[1],l=Object(f.useState)(null),d=Object(u.a)(l,2),h=d[0],g=d[1],j=Object(f.useState)(e),p=Object(u.a)(j,2),b=p[0],O=p[1];return console.log("FETCH ",b),Object(f.useEffect)((function(){b&&(g(!0),c(null),s(null),fetch(b).then((function(e){return e.json()})).then((function(e){g(!1),c(e)})).catch((function(e){g(!1),s(e)})))}),[b]),{data:r,error:a,isLoading:h,setUrl:O}},I=n(22),T=n(5),C=n(1084),E=n.n(C),D=(n(1086),n(1));T.a.init();var k=j.default.div(r||(r=Object(h.a)(["\n  margin: 10px;\n  border: 2px outset;\n  border-radius: 8px;\n  min-height: 200px;\n  min-width: 200px;\n"]))),R=j.default.div(c||(c=Object(h.a)(["\n  height: 24px;\n  position: relative;\n  left: 197px;\n  top: 23px;\n  opacity: 0;\n  cursor: ",";\n  &:hover {\n    opacity: ",";\n  }\n"])),(function(e){return e.open?"default":"pointer"}),(function(e){return e.open?0:1})),L=Object(j.default)(p.Flex)(i||(i=Object(h.a)(["\n  /*\nwidth: 100%;\nheight: 100vh;\ndisplay: flex;\n*/\n  flex-wrap: wrap;\n  flex-direction: row;\n  align-content: flex-start;\n  justify-content: flex-start;\n  position: relative;\n  top: 0px;\n  left: 0px;\n  overflow-y: auto;\n"]))),A=j.default.div(o||(o=Object(h.a)(["\n  width: 100%;\n  height: 100vh;\n  z-index: 5;\n  background-color: rgba(30, 29, 29, 0.3);\n  position: absolute;\n  left: 0;\n  top: 0;\n"]))),N=j.default.div(a||(a=Object(h.a)(["\n  width: ","px;\n  /* height: 100vh; */\n  max-height: 400px;\n  overflow-y: auto;\n  z-index: 20;\n  background-color: white;\n  position: absolute;\n  left: ","px;\n  top: ","px;\n  padding-top: 10px;\n  padding-left: 10px;\n  padding-right: 10px;\n"])),(function(e){return e.width}),(function(e){return e.left}),(function(e){return e.top})),P=j.default.div(s||(s=Object(h.a)(["\n  background-color: white;\n\n  width: 100%;\n  height: 100%;\n  border: 2px outset;\n  border-radius: 8px;\n  z-index: 10;\n"]))),W=g.a.memo((function(e){var t=e.widgetList,n=e.widgetData;return console.log("WIDGET LIST ",t),console.log("WIDGET DATA",n),Object(D.jsx)(D.Fragment,{children:t.map((function(e,t){return Object(D.jsx)(e,{data:{settings:n[t].currentSetting}},"prifina-widget-"+t)}))})})),B=function(e){var t=e.widgetIndex,n=e.widgetSetting,r=e.onUpdate,c=Object(d.a)(e,["widgetIndex","widgetSetting","onUpdate"]);console.log("SETTINGS ",t,n);var i=Object(f.useRef)({}),o=Object(f.useRef)([]),a=Object(f.useRef)(),s=Object(f.useState)(!1),l=Object(u.a)(s,2),h=l[0],j=l[1];Object(f.useEffect)((function(){Object.keys(n.currentSetting).forEach((function(e){i.current[e]=n.currentSetting[e]})),console.log("FLDS ",i),console.log("DIALOG ",c);var e=[];n.settings.forEach((function(t){console.log(t),-1===e.indexOf(t.type)&&e.push(t.type)})),e.indexOf("TZ")>-1&&E.a.tz.names().forEach((function(e){o.current.push({text:e+": "+E.a.tz(e).format("Z"),tz:e,offset:E.a.tz(e).utcOffset()})})),j(!0)}),[]);var O=Object(b.a)(i.current),x=Object(u.a)(O,2),v=x[0],w=x[1];if(console.log("RENDER FIELDS ",v,i),o.current.length>0){var m=E.a.tz(v.tz).utcOffset();console.log("TZ ",i,m),m!==i.current.offset&&(i.current.offset=m,i.current.tz=v.tz,console.log("INPUT ",a),a.current&&(a.current.value=m),w({target:{id:"offset",value:m}}))}return Object(D.jsxs)(p.Box,{m:2,children:[Object(D.jsx)(p.Text,{textStyle:"h3",textAlign:"center",mt:10,children:n.title}),Object(D.jsx)(p.Divider,{}),h&&Object(D.jsxs)(p.Box,{mt:10,ml:5,mr:5,children:[n.settings.map((function(e,t){return Object(D.jsxs)(g.a.Fragment,{children:["text"===e.type&&Object(D.jsx)(p.Input,{mt:15,placeholder:e.label,mb:2,id:e.value,name:e.value,defaultValue:v[e.value],onChange:w,ref:a},"widget-setting-"+t),"TZ"===e.type&&Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(p.Label,{mt:10,children:e.label},"setting-label-"+t),Object(D.jsx)(p.Select,{mb:10,size:"sm",id:e.value,name:e.value,defaultValue:v[e.value],onChange:w,children:o.current.map((function(e,n){return Object(D.jsx)("option",{value:e.tz,children:e.text},"widget-setting-"+t+"-"+n)}))},"widget-setting-"+t)]})]},"settings-"+t)})),Object(D.jsx)(p.Box,{mt:10,children:Object(D.jsx)(p.Button,{width:"100%",onClick:function(e){console.log("UPDATE BUTTON ",v),o.length>0&&v.hasOwnProperty("tz")?r({tz:v.tz,offset:E.a.tz(v.tz).utcOffset()}):r(v)},children:"Update"})})]})]})},z=Object(f.forwardRef)((function(e,t){var n=e.showHistory,r=e.chevronOpen,c=e.searchKey,i=e.searchOpen,o=e.saveSearchKey,a=Object(b.a)({search:""}),s=Object(u.a)(a,2),l=s[0],d=s[1],h=Object(f.useRef)();return Object(D.jsx)(p.Box,{ml:10,mr:10,ref:t,children:Object(D.jsxs)(p.IconField,{children:[Object(D.jsx)(p.IconField.LeftIcon,{iconify:x.a,color:"componentPrimary",size:"17"}),Object(D.jsx)(p.IconField.InputField,{ref:h,autoFocus:!0,placeholder:T.a.__("Search"),id:"search",name:"search",onChange:d,onKeyDown:function(e){"Enter"===e.key&&(o(l.search),c(l.search))}}),Object(D.jsx)(p.Box,{display:"inline-flex",onClick:function(){i||n((function(e){return!e})),h.current.value="",c("")},children:Object(D.jsx)(p.IconField.RightIcon,{iconify:r||i?w.a:y.a,color:"componentPrimary",size:"17"})})]})})})),K=function(e){var t=e.searchBox,n=e.searchKey,r=e.roleKey,c=e.saveSearchResult,i=t.current.getBoundingClientRect(),o={width:i.width,left:i.left,top:i.top+i.height+5};console.log(o),console.log("NEW SEARCH ",n);var a=Object(f.useState)(null),s=Object(u.a)(a,2),d=s[0],h=s[1],g=S(),j=g.data,b=g.error,O=g.isLoading,x=g.setUrl;return Object(f.useEffect)((function(){if(O||x("".concat(I.b,"?cx=").concat(I.c,"&exactTerms=").concat(r.length>0?encodeURIComponent(r):"","&q=").concat(encodeURIComponent(n),"&lr=lang_en&key=").concat(I.a)),b&&h(Object(D.jsxs)("h2",{children:["Error when fetching: ",b]})),!j&&O&&h(Object(D.jsx)("h2",{children:"LOADING..."})),j||O||h(null),j){console.log(j);var e=j.items.map((function(e,t){return Object(D.jsxs)("li",{children:[Object(D.jsx)("div",{children:Object(D.jsx)("a",{href:e.link,"data-link":t,onClick:function(e){var t=parseInt(e.currentTarget.dataset.link);console.log("LINK CLICK ",j.items[t]),c(n,j.items[t])},target:"_blank",children:e.title})}),Object(D.jsx)("div",{style:{fontSize:"0.75rem"},children:e.snippet})]},"search-result-"+t)}));h(Object(D.jsx)("ol",{children:e}))}}),[n,b,O,j]),Object(D.jsx)(D.Fragment,{children:Object(D.jsxs)(N,Object(l.a)(Object(l.a)({},o),{},{children:[Object(D.jsx)(p.Text,{textStyle:"h4",children:"Search results"}),Object(D.jsx)(p.Divider,{}),d]}))})},F=function(e){var t=e.searchBox;console.log("HISTORY ",t);var n=t.current.getBoundingClientRect(),r={width:n.width,left:n.left,top:n.top+n.height+5};console.log(r);var c=[];return Object(D.jsx)(D.Fragment,{children:Object(D.jsxs)(N,Object(l.a)(Object(l.a)({},r),{},{children:[Object(D.jsx)(p.Text,{textStyle:"h4",children:"Search history"}),Object(D.jsx)(p.Divider,{}),Object(D.jsx)("ol",{children:c.length>0&&c.map((function(e,t){return Object(D.jsx)("li",{children:e.search},"search-"+t)}))})]}))})}},445:function(e,t,n){"use strict";n.r(t);var r=n(16),c=n.n(r),i=n(7),o=n(31),a=n(9),s=n(0),l=n.n(s),u=n(202),d=n(46),h=n(1093),f=n.n(h),g=n(1094),j=n.n(g),p=n(201),b=n.n(p),O=n(248),x=n(435),v=n(1095),w=Object(x.createRequires)(v.resolve),m=Object(x.createRemoteComponent)({requires:w}),y=n(1087),S=n(5),I=n(50),T=n(104),C=n(242),E=n(22),D=n(71),k=n(433),R=n(58),L=n(1),A=n(1100);S.a.init();E.d.appSync.aws_appsync_graphqlEndpoint,E.d.main_region,E.d.appSync.aws_appsync_authenticationType,E.d.cognito.USER_POOL_ID,E.d.cognito.IDENTITY_POOL_ID,E.d.cognito.APP_CLIENT_ID,E.d.main_region;var N={AWSS3:{bucket:E.d.S3.bucket,region:E.d.S3.region}},P=function(e){return function(t){return e[t]}};t.default=function(e){var t=e.widgetConfigData,n=e.appSyncClient,r=e.prifinaID;console.log("PROPS ",t,Object.keys(t)),console.log("DISPLAY APP ",r);var h=Object(u.usePrifina)(),g=(h.check,h.currentUser),p=(h.getLocalization,h.getSettings,h.setSettings),x=h.getCallbacks,v=h.registerClient,w=(h.API,h.Prifina);h.activeRole;console.log("DISPLAY APP ",g);var S=new w({appId:"WIDGETS"});I.default.configure(N);var E=Object(s.useState)([]),W=Object(a.a)(E,2),B=W[0],z=W[1],K=Object(s.useState)(t),F=Object(a.a)(K,2),G=F[0],U=(F[1],Object(s.useState)(0)),_=Object(a.a)(U,2),H=_[0],Y=_[1],q=Object(s.useState)(!1),M=Object(a.a)(q,2),Z=M[0],J=M[1],V=Object(s.useRef)(),Q=Object(s.useState)(""),X=Object(a.a)(Q,2),$=X[0],ee=X[1],te=Object(s.useState)(!1),ne=Object(a.a)(te,2),re=ne[0],ce=ne[1],ie=Object(s.useState)(!1),oe=Object(a.a)(ie,2),ae=oe[0],se=oe[1],le=Object(s.useRef)(),ue=Object(s.useRef)({left:"0px",top:"0px",height:"0px",width:"0px",widget:-1}),de=[{},{}],he=Object(s.useRef)(de.map((function(e,t){return t}))),fe=Object(O.c)(de.length,P(he.current)),ge=Object(a.a)(fe,2),je=ge[0],pe=ge[1],be=Object(s.useRef)([]),Oe=Object(s.useRef)([]),xe=Object(s.useRef)(t.map((function(e,t){return{settings:e.widget.settings||[],title:e.widget.title,appId:e.widget.appID,installCount:e.widget.installCount,currentSetting:e.currentSetting}}))),ve=function(){var e=Object(o.a)(c.a.mark((function e(t){var n,r,o,a,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={fileName:"component.png",type:"image/png",html2CanvasOptions:{}},-1===t){e.next=11;break}return r=document.querySelectorAll("[data-widget-index='"+t+"']")[0],o=b.a.findDOMNode(r),e.next=6,j()(o,Object(i.a)({scrollY:-window.scrollY,useCORS:!0},n));case 6:a=e.sent,s=a.toDataURL(n.type,1),console.log("NEW SNAPSHOT TAKEN..."),le.current=s,ce(!0);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){console.log("OPEN CHANGE ",re),re?(he.current=[{opacity:1,transform:"perspective(1000px) rotateY(180deg)",width:ue.current.width,height:ue.current.height,visibility:"visible",config:{mass:5,tension:500,friction:80},reset:!0,onStart:function(){}},{delay:500,reset:!0,from:{transform:"none",width:ue.current.width,height:ue.current.height,visibility:"visible"},to:{transform:"none",width:"400px",height:"400px",visibility:"visible"},onStart:function(){Oe.current[0]&&se(!0)},onRest:function(){Oe.current[1]}}],pe(P(he.current))):-1!=ue.current.widget&&(console.log("INIT SPRINGS...."),he.current=[{},{}],pe(P(he.current)),se(!1),Oe.current=[],ue.current={left:"0px",top:"0px",height:"0px",width:"0px",widget:-1})}),[re]),Object(s.useEffect)((function(){v([n,T.a,C.a]),console.log("WIDGET CONFIG ",G)}),[]),Object(s.useEffect)((function(){if(G.length>0){console.log("CREATE WIDGETS...");var e=G.map((function(e,t){return console.log("WIDGET COMPONENT ",e),Object(s.forwardRef)((function(n,r){return console.log("W ",n),Object(L.jsx)(l.a.Fragment,{children:Object(L.jsxs)("div",{children:[e.settings&&Object(L.jsx)(k.IconDiv,{open:n.open,onClick:function(){return function(e){if(!re){console.log("CLICK...",e);var t=document.querySelectorAll("[data-widget-index='"+e+"']")[0].getBoundingClientRect();console.log("WW...",t),ue.current={left:t.left+"px",top:t.top+"px",height:t.height+"px",width:t.width+"px",widget:e},he.current=[{opacity:1,transform:"perspective(1000px) rotateY(0deg)",height:t.height+"px",width:t.width+"px",visibility:"visible",reset:!0,config:{mass:5,tension:500,friction:80,duration:1e3},onRest:function(){},onStart:function(){}},{delay:500,reset:!0,from:{transform:"none",width:t.width+"px",height:t.height+"px",visibility:"hidden"},to:{transform:"none",width:"400px",height:"400px",visibility:"hidden"}}],pe(P(he.current)),ve(e)}}(t)},children:Object(L.jsx)(d.BlendIcon,{iconify:f.a})}),Object(L.jsx)(k.WidgetWrapper,{className:"prifina-widget","data-widget-index":t,ref:r,children:Object(L.jsx)(m,Object(i.a)({url:e.url},n))},"widget-wrapper-"+t)]})})}))}));console.log("WIDGETS ",e),z(e)}}),[G]);var we=function(e){console.log("Update settings ",e),console.log("HOOK ",S),console.log(ue.current,xe);var t=[];Object.keys(e).forEach((function(n){xe.current[ue.current.widget].currentSetting[n]=e[n],t.push({field:n,value:e[n]})}));var n=xe.current[ue.current.widget].appId;console.log("NEW SETTINGS ",t,n),p(n,r,{type:"WIDGET",index:ue.current.widget,settings:t});var c=x();console.log("CALLBACKS ",c);var i=xe.current[ue.current.widget].installCount;console.log(" CALLBACK ",c.hasOwnProperty(n),i),console.log(" CALLBACK ",typeof c[n][i]),c.hasOwnProperty(n)&&"function"===typeof c[n][i]&&(console.log("FOUND CALLBACK "),c[n][i]({settings:e})),ce(!1)},me=function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=3;break}return e.next=3,n.mutate({mutation:Object(D.a)(R.b),variables:{input:{owner:g.uuid,searchKey:t,role:0===H?"":roleKey[H]}}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ye=function(){var e=Object(o.a)(c.a.mark((function e(t,r){var i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=6;break}return i="search-results/"+A.generate()+".json",e.next=4,n.mutate({mutation:Object(D.a)(R.c),variables:{input:{owner:g.uuid,searchKey:t,role:0===H?"":roleKey[H],selectedResult:i}}});case 4:return e.next=6,C.a.put(i,JSON.stringify(r),{level:"public",contentType:"application/json",metadata:{owner:g.uuid,searchKey:t,created:(new Date).toISOString()}});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(L.jsxs)(L.Fragment,{children:[re&&Object(L.jsx)(k.ModalBackground,{className:"widget-modal",onClick:function(e){console.log("TARGET ",e),console.log("WIDGET SETTINGS ",be.current,ue),console.log("MODAL ",e.target.className),e.target.className.indexOf("widget-modal")>-1&&ce(!1)},children:je.map((function(e,t){return console.log("IMAGE ",le),console.log(ue.current),console.log(xe),Object(L.jsx)(O.a.div,{style:{transform:e.transform,left:ue.current.left,top:ue.current.top,width:e.width,height:e.height,position:"absolute",visibility:e.visibility,zIndex:2},ref:function(e){null!==e&&Oe.current.push(e)},children:Object(L.jsxs)(k.SettingsDiv,{children:[0===t&&Object(L.jsx)("img",{src:le.current,style:{width:"100%",height:"100%",display:"".concat(ae?"none":"block")}}),ae&&1===t&&Object(L.jsx)(k.SettingsDialog,{spring:t,flipped:ae,open:re,onUpdate:we,widgetIndex:ue.current.widget,widgetSetting:xe.current[ue.current.widget]})]})},"animated-"+t)}))}),Object(L.jsx)("div",{style:{overflow:"hidden"},children:Object(L.jsxs)(y.Tabs,{activeTab:H,onClick:function(e,t){console.log("Click",e),console.log("TAB",t),Y(t)},style:{height:"100%"},children:[Object(L.jsxs)(y.TabList,{children:[Object(L.jsx)(y.Tab,{children:g.name}),Object(L.jsx)(y.Tab,{children:"Work"}),Object(L.jsx)(y.Tab,{children:"Family"}),Object(L.jsx)(y.Tab,{children:"Hobbies"})]}),Object(L.jsxs)(y.TabPanelList,{children:[Object(L.jsxs)(y.TabPanel,{style:{height:"100vh",paddingBottom:"50px",overflow:"auto"},children:[Object(L.jsxs)("div",{style:{overflow:"hidden"},children:[Object(L.jsx)(k.SearchBox,{ref:V,showHistory:J,chevronOpen:Z,searchKey:ee,searchOpen:$.length>0,saveSearchKey:me}),$.length>0&&!Z&&Object(L.jsx)(k.SearchResults,{searchBox:V,searchKey:$,roleKey:["","work","family","hobbies"][H],saveSearchResult:ye}),Z&&Object(L.jsx)(k.SearchHistory,{searchBox:V})]}),Object(L.jsx)("div",{style:{overflow:"auto"},children:Object(L.jsx)(k.WidgetContainer,{className:"prifina-widget-container",children:B.length>0&&Object(L.jsx)(k.WidgetList,{widgetList:B,widgetData:G})})})]}),Object(L.jsx)(y.TabPanel,{children:"Work panel"}),Object(L.jsx)(y.TabPanel,{children:"Family panel"}),Object(L.jsx)(y.TabPanel,{children:"Hobbies panel"})]})]})})]})}}}]);
//# sourceMappingURL=3.2c51b08a.chunk.js.map